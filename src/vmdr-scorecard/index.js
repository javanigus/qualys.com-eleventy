"use strict";/* global Swiper jQuery MktoForms2 */ /*
 * Enable fancybox overlay popup
 */ // Initial call to the function when the page is loaded
/*
 * before submitting the form, calculate the score and then redirect the user to a URL like
	https://qualys-html-to-pdf-0d3555d590c9.herokuapp.com/generate-pdf?grade=a%2b&name=Abdullah%20Yahya&company=Qualys&designation=Product%20Manager,%20Web&country=United%20States

   client-side JS marketo code processes in the following order:
	1. /asset/script/marketo.js
	2. /vmdr-health-check/index.js (this script)
 */(function(a){"use strict";a("[data-fancybox]").fancybox({toolbar:!1,smallBtn:!0,iframe:{preload:!1}})})(jQuery),function(a,b){"use strict";function c(){let a=!!(0<arguments.length&&arguments[0]!==void 0)&&arguments[0];var b=document.querySelector("fieldset.swiper-slide-active");if(b){let c=b.querySelectorAll(".question"),d=Array.from(c,a=>{let b=a.querySelector(".choices");return!!b&&Array.from(b.children).some(a=>a.classList.contains("checked"))}),e=d.filter(a=>a).length,f=document.querySelector(".paragraph--1.info-text");if(e===c.length){if(f.style.display="none",!a){let a=document.querySelector(".swiper-button-next");a.classList.remove("swiper-button-disabled")}else document.getElementById("mock-submit").disabled=!1;}else if(e<c.length)if(f.style.display="block",!a){let a=document.querySelector(".swiper-button-next");a.classList.add("swiper-button-disabled")}else document.getElementById("mock-submit").classList.add("swiper-button-next","swiper-button-disabled")}}function d(a){// Initialize sumOfGrades to keep track of the total numeric value of grades
let b,c=0;// Iterate through grades array and convert each grade to its numeric value
return a.forEach(a=>{c+=f[a]||0}),b=45<c?"A+":25<c&&45>=c?"A":"B",b.toLowerCase()}var e=new Swiper("#questionnaire-swiper",{slidesPerView:1,navigation:{nextEl:".swiper-button-next",prevEl:".swiper-button-prev"},pagination:{el:".swiper-pagination",type:"progressbar"},autoHeight:!0,autoplay:!1,allowSlideClick:!1,spaceBetween:30,effect:"fade",fadeEffect:{crossFade:!0},on:{touchStart:function touchStart(){e.allowSlidePrev=!1,e.allowSlideNext=!1},touchEnd:function touchEnd(){e.allowSlidePrev=!0,e.allowSlideNext=!0},slideChange:function slideChange(){var a=document.getElementById("questionnaire-section"),b=a?a.offsetTop-document.querySelector(".q-header").offsetHeight:0;a&&window.scrollTo({top:b,behavior:"smooth"})},slideChangeTransitionEnd:function slideChangeTransitionEnd(){let a=this.activeIndex,b=document.getElementsByClassName("swiper-slide").length-1;if(a===b){let a=document.querySelector(".swiper-button-next");a.textContent="Submit",a.classList.contains("swiper-button-next")?(a.classList.remove("swiper-button-next"),a.setAttribute("id","mock-submit"),document.getElementById("mock-submit").disabled="true",document.getElementById("mock-submit").addEventListener("click",function(a){a.preventDefault(),document.querySelector("button[type='submit'].mktoButton").click()})):console.log("id already exists"),c(!0)}else c(!1)}}});const f={"A+":3,A:2,B:1,F:0},g={"A+":["sensorsRange02","sensorsRange03","sensorsRange04","sensorsRange05","sensorsRange07","sensorsRange09","sensorsRange10"],A:["sensorsRange02","sensorsRange04","sensorsRange09","sensorsRange10","sensorsRange05"],B:["sensorsRange01","sensorsRange04","sensorsRange10","sensorsRange11"]},h={frequency01:"A+",frequency02:"A+",frequency03:"A",frequency04:"B",frequency05:"F"},i={percentage01:"A+",percentage02:"A",percentage03:"B",percentage04:"B"},j={classifygroup01:"A+",classifygroup02:"F",classifygroup03:"F",classifygroup04:"A",classifygroup05:"B"},k={digitalCertificates01:"A+",digitalCertificates02:"A",digitalCertificates03:"A",digitalCertificates04:"B",digitalCertificates05:"F"},l={authentication01:"A+",authentication02:"A",authentication03:"B",authentication04:"B"},m={agentlessTracking01:"B",agentlessTracking02:"B",agentlessTracking03:"A+",agentlessTracking04:"A",agentlessTracking05:"F"},n={mergeVulnerability01:"A+",mergeVulnerability02:"B"},o={exploitableVulnerabilities01:"B",exploitableVulnerabilities02:"A",exploitableVulnerabilities03:"A",exploitableVulnerabilities04:"A+"},p={SCA01:"A",SCA02:"A+",SCA03:"A+",SCA04:"A",SCA05:"B"},q={pCIASVScanning01:"A+",pCIASVScanning02:"B",pCIASVScanning03:"F"},r={createTickets01:"A+",createTickets02:"A+",createTickets03:"A+",createTickets04:"A",createTickets05:"A",createTickets06:"B"},s={prioritizingVulnerabilities01:"A",prioritizingVulnerabilities02:"A",prioritizingVulnerabilities03:"A+",prioritizingVulnerabilities04:"B",prioritizingVulnerabilities05:"F"},t={prioritizingAssets01:"A+",prioritizingAssets02:"A+",prioritizingAssets03:"B",prioritizingAssets04:"F"},u={mitreATTCK01:"A+",mitreATTCK02:"A+",mitreATTCK03:"B",mitreATTCK04:"F"},v={patchesDeploy01:"B",patchesDeploy02:"A+",patchesDeploy03:"A"},w={purgeRules01:"A+",purgeRules02:"A",purgeRules03:"B"};// question 2 mapping
// question 3 mapping
// question 4 mapping
// question 5 mapping
// question 6 mapping
// question 7 mapping
// question 8 mapping
// question 9 mapping
// question 10 mapping
// question 11 mapping
// question 12 mapping
// question 13 mapping
// question 14 mapping
// question 15 mapping
// question 16 mapping
// question 17 mapping
c();let x,y,z;z=document.getElementById("questionnaire-form"),b.whenReady(function(b){function e(a){function b(a){return a.reduce((a,b)=>a+b,0)}const c={},d=document.querySelectorAll(".questionnaire");d.forEach(function(a,b){const d={},e=a.querySelectorAll("input");e.forEach(function(a){const b=a.getAttribute("name"),c=a.value;d[b]=c}),c["fieldset"+(b+1)]=d});const e={};for(const b in c)if(c.hasOwnProperty(b)){const d=c[b],f={};for(const b in d)if(d.hasOwnProperty(b)){const c=a.find(a=>a.name===b);c&&(f[b]=c.grade)}e[b]=f}(function(a){for(const b in a)if(a.hasOwnProperty(b)){const c=a[b];for(const a in c)c.hasOwnProperty(a)&&void 0!==f[c[a]]&&(c[a]=f[c[a]])}})(e);const g=function(a){const b={};for(const c in a)if(a.hasOwnProperty(c)){const d=a[c];b[c]=Object.values(d)}return b}(e),h=function(a){const c={};for(const d in a)if(a.hasOwnProperty(d)){const e=b(a[d]);c[d]=e}return c}(g),i=function(a){const b={};for(const c in a)if(a.hasOwnProperty(c)){const d=a[c];// Apply logic based on fieldsetKey
let e="fieldset1"===c?11<=d?"A+":6<d&&11>d?"A":6>=d?"B":"F":"fieldset2"===c?22<=d?"A+":12<d&&22>d?"A":12>=d?"B":"F":"fieldset3"===c?11<=d?"A+":6<d&&11>d?"A":6>=d?"B":"F":"fieldset4"===c?3===d?"A+":2===d?"A":1===d?"B":"F":d;b[c]=e}return b}(h);return i}function A(a){let b;switch(a){case"vMDRScorecardSensorsRange":{const c=z.querySelectorAll("input[name='".concat(a,"']:checked")),d=[...c].map(a=>a.value);b=Object.keys(g).find(a=>g[a].every(a=>d.includes(a)))||"F";break}case"vMDRScorecardFrequency":b=h[z.querySelector("input[name='".concat(a,"']:checked")).value];break;case"vMDRScorecardPercentage":b=i[z.querySelector("input[name='".concat(a,"']:checked")).value];break;case"vMDRScorecardClassifygroup":b=j[z.querySelector("input[name='".concat(a,"']:checked")).value];break;case"vMDRScorecardDigitalCertificates":b=k[z.querySelector("input[name='".concat(a,"']:checked")).value];break;case"vMDRScorecardAuthentication":b=l[z.querySelector("input[name='".concat(a,"']:checked")).value];break;case"vMDRScorecardAgentlessTracking":b=m[z.querySelector("input[name='".concat(a,"']:checked")).value];break;case"vMDRScorecardMergeVulnerability":b=n[z.querySelector("input[name='".concat(a,"']:checked")).value];break;case"vMDRScorecardExploitableVulnerabilities":b=o[z.querySelector("input[name='".concat(a,"']:checked")).value];break;case"vMDRScorecardSCA":b=p[z.querySelector("input[name='".concat(a,"']:checked")).value];break;case"vMDRScorecardPCIASVScanning":b=q[z.querySelector("input[name='".concat(a,"']:checked")).value];break;case"vMDRScorecardCreateTickets":b=r[z.querySelector("input[name='".concat(a,"']:checked")).value];break;case"vMDRScorecardPrioritizingVulnerabilities":b=s[z.querySelector("input[name='".concat(a,"']:checked")).value];break;case"vMDRScorecardPrioritizingAssets":b=t[z.querySelector("input[name='".concat(a,"']:checked")).value];break;case"vMDRScorecardMitreATTCK":b=u[z.querySelector("input[name='".concat(a,"']:checked")).value];break;case"vMDRScorecardPatchesDeploy":b=v[z.querySelector("input[name='".concat(a,"']:checked")).value];break;case"vMDRScorecardPurgeRules":b=w[z.querySelector("input[name='".concat(a,"']:checked")).value];break;default:b="F"}// return grade;
return void 0===b&&(console.error("input with name ".concat(a," was not found")),b="F"),{name:a,grade:b}}// const gradeAcquiredArray = [];
function B(b){// disableNextBtn();
let c=b.target.name,d=a(b.target).parents(".question");const e=a(d[0]).find(".choices");if(0<e.length&&"true"==F)// Fetch the checked values and their label texts
{let b=A(c);const d=b.grade,g="Points Scored: ".concat(f[d],"<br/>Grade Obtained: ").concat(d),h=e.children(".ques-grade");0<h.length?a(h).html(g):e.append("<pre class=\"ques-grade\" style=\"color: #ED2E26;\">".concat(g,"</pre>"))}}let C,D;const E=new URLSearchParams(window.location.search),F=E.get("debug");let G=z.querySelectorAll("input[type='checkbox']");G.forEach(function(a){a.addEventListener("change",B)});let H=z.querySelectorAll("input[type='radio']");H.forEach(function(a){a.addEventListener("change",B)}),z.addEventListener("submit",function(a){a.preventDefault()}),document.addEventListener("change",function(a){a.target.matches(".swiper-slide-active input")&&c()}),b.onSubmit(function(a){var b,c,f={},g=z.querySelectorAll("input");for(var h of g){"radio"===h.type&&h.checked?(c=h.closest("label").innerText.trim(),f[h.name]=c):"checkbox"===h.type&&h.checked&&(!f[h.name]&&(f[h.name]=[]),c=h.closest("label").innerText.trim(),f[h.name].push(c));var i=document.querySelector(".mktoForm.q-form"),j=i.querySelector("[name=\"".concat(h.name,"\"]"));j&&(j.value=f[h.name])}b=a.getFormElem();const k=b.find("input[name='FirstName']").val(),l=b.find("input[name='LastName']").val();x="".concat(k," ").concat(l),y=b.find("input[name='Company']").val();const m=[A("vMDRScorecardSensorsRange"),A("vMDRScorecardFrequency"),A("vMDRScorecardPercentage"),A("vMDRScorecardClassifygroup"),A("vMDRScorecardDigitalCertificates"),A("vMDRScorecardAuthentication"),A("vMDRScorecardAgentlessTracking"),A("vMDRScorecardMergeVulnerability"),A("vMDRScorecardExploitableVulnerabilities"),A("vMDRScorecardSCA"),A("vMDRScorecardPCIASVScanning"),A("vMDRScorecardCreateTickets"),A("vMDRScorecardPrioritizingVulnerabilities"),A("vMDRScorecardPrioritizingAssets"),A("vMDRScorecardMitreATTCK"),A("vMDRScorecardPatchesDeploy"),A("vMDRScorecardPurgeRules")],n=Object.values(m),o=e(m),p=n.map(a=>a.grade),q=p.map(function(a,b){return"q".concat(b+1,"=").concat(encodeURIComponent(a.toLowerCase()))}),r=Object.entries(o).map(a=>{let[b,c]=a;return"s".concat(parseInt(b.slice(-1)),"=").concat(encodeURIComponent(c.toLowerCase()))});C=d(p),D="grade=".concat(encodeURIComponent(C),"&name=").concat(encodeURIComponent(x),"&company=").concat(encodeURIComponent(y),"&").concat(r.join("&"),"&").concat(q.join("&"));var s="https://qualys-html-to-pdf-0d3555d590c9.herokuapp.com/generate-pdf?"+D.toString();b.find("input[name='pDFURL']").val(s)}),b.onSuccess(function(){const a=window.location.pathname;return window.location="".concat(a,"confirm/?").concat(D),!1})})}(jQuery,MktoForms2);
//# sourceMappingURL=index.js.map