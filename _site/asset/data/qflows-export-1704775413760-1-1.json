[
  {
    "id": "75ec3239-0f05-483b-b234-b997b46ae74a",
    "createdAt": 1698753551531,
    "updatedAt": 1704765588628,
    "tags": [
      "created_by=ec28420a-885d-7409-8339-b2158b94bf65"
    ],
    "workflow": "75ec3239-0f05-483b-b234-b997b46ae74a",
    "revision": "da74133d2e4709a470620a0cd43b2612cadc70b871d42adb5628be9240ed21a7",
    "definition": "{\"variables\":[{\"key\":\"region\",\"value\":[\"us-east-1\"]},{\"key\":\"resourceGroup\",\"value\":[]},{\"key\":\"project\",\"value\":[]},{\"key\":\"credentials\",\"value\":[\"@16e88254-211b-340f-9c7f-394062923db3\"]},{\"key\":\"credentials_azure\",\"value\":[]},{\"key\":\"credentials_gcp\",\"value\":[]}],\"components\":[{\"id\":\"trigger\",\"type\":\"trigger\",\"next\":\"node-248b884b-resource\",\"previous\":null,\"inputs\":{\"event\":{\"active\":false,\"value\":{\"cloudProvider\":\"\",\"pattern\":{},\"selectedEventsFiltersState\":[],\"selectedEventsName\":\"\",\"selectedFilters\":[{\"values\":[\"\"],\"key\":\"\"}],\"selectedServiceName\":\"\"}},\"cloudview\":{\"active\":true},\"schedule\":{\"active\":false,\"value\":[]}},\"target\":{\"script\":\"trigger\"},\"selectedResource\":null,\"conditionalSettings\":{\"conditions\":[],\"expression\":\"\"},\"advanceOptions\":{}},{\"id\":\"node-248b884b-resource\",\"type\":\"resource\",\"next\":\"node-283706f4-resource\",\"previous\":\"trigger\",\"inputs\":{\"resourceType\":\"S3_BUCKET\",\"service\":\"S3\",\"method\":\"listBuckets\",\"params\":{},\"addOns\":[]},\"target\":{\"script\":\"awsapi\"},\"selectedResource\":null,\"conditionalSettings\":{\"conditions\":[],\"expression\":\"\"},\"advanceOptions\":{}},{\"id\":\"node-283706f4-resource\",\"type\":\"resource\",\"next\":\"node-f77921c2-filter\",\"previous\":\"node-248b884b-resource\",\"inputs\":{\"resourceType\":\"Route53_HOSTED_ZONE\",\"service\":\"Route53\",\"method\":\"listHostedZones\",\"params\":{\"DelegationSetId\":\"<optional>\"},\"addOns\":[{\"service\":\"Route53\",\"displayService\":\"Route53\",\"displayResourceType\":\"Route53_RESOURCE_RECORD_SET\",\"method\":\"listResourceRecordSets\",\"resourceType\":\"Route53_RESOURCE_RECORD_SET\",\"displayName\":\"Resource Record Sets\",\"isDependent\":true,\"active\":false,\"params\":{\"HostedZoneId\":\"obj.Id\",\"MaxItems\":\"<optional>\",\"StartRecordName\":\"<optional>\",\"StartRecordType\":\"<optional>\",\"StartRecordIdentifier\":\"<optional>\"}}]},\"target\":{\"script\":\"awsapi\"},\"selectedResource\":null,\"conditionalSettings\":{\"conditions\":[],\"expression\":\"\"},\"advanceOptions\":{\"suppressAddonError\":false}},{\"id\":\"node-f77921c2-filter\",\"type\":\"filter\",\"next\":\"node-19281e97-custom\",\"previous\":\"node-283706f4-resource\",\"inputs\":{\"conditions\":[{\"id\":\"c1\",\"type\":\"param\",\"key\":\"$.Type\",\"value\":\"CNAME\",\"operator\":\"==\"}],\"expression\":\"( (c1) )\"},\"target\":{\"script\":\"customFilter\"},\"selectedResource\":{\"label\":\"AWSResource (2).HostedZones.addOns.ResourceRecordSets\",\"selectedResourceId\":\"node-283706f4-resource\",\"path\":\"addOns.ResourceRecordSets.data\",\"context\":{\"outputPath\":\"addOns.ResourceRecordSets.data\"}},\"conditionalSettings\":{\"conditions\":[],\"expression\":\"\"},\"advanceOptions\":{}},{\"id\":\"node-19281e97-custom\",\"type\":\"custom\",\"next\":\"node-69d49ad-filter\",\"previous\":\"node-f77921c2-filter\",\"inputs\":{\"variables\":{},\"code\":\"async function process(){\\n  let result = [];\\n  let {collection,region} = context;\\n  collection.forEach(item => {\\n   const url = item.ResourceRecords[0].Value;\\n   const bucketName = extractBucketName(url);\\n  if (bucketName) {\\n    item.ExpectedBucketName = bucketName;\\n  }\\n  else {\\n    item.ExpectedBucketName = \\\"Not Vulnerable to AWS S3 Sub-domain Takeover\\\";\\n  }\\n  result.push(item)\\n})\\n  exit(null,result)\\n}\\nprocess().catch(exit);\\n\\n\\nfunction extractBucketName(url) {\\n  const regex = /([a-zA-Z0-9.-]+)\\\\.s3-website-[a-zA-Z0-9.-]+\\\\.amazonaws\\\\.com/;\\n  const match = url.match(regex);\\n  return match ? match[1] : null;\\n}\"},\"target\":{\"script\":\"customJavascript\"},\"selectedResource\":{\"selectedResourceId\":\"node-f77921c2-filter\",\"path\":\"\",\"label\":\"Filter.ResourceRecordSets\",\"context\":{\"outputPath\":\"addOns.ResourceRecordSets.data\"}},\"conditionalSettings\":{\"conditions\":[],\"expression\":\"\"},\"advanceOptions\":{}},{\"id\":\"node-69d49ad-filter\",\"type\":\"filter\",\"next\":\"node-cfba3819-data-formatter\",\"previous\":\"node-19281e97-custom\",\"inputs\":{\"conditions\":[{\"id\":\"c1\",\"type\":\"param\",\"key\":\"$.ExpectedBucketName\",\"value\":\"Not Vulnerable to AWS S3 Sub-domain Takeover\",\"operator\":\"!=\"}],\"expression\":\"( (c1) )\"},\"target\":{\"script\":\"customFilter\"},\"selectedResource\":{\"selectedResourceId\":\"node-19281e97-custom\",\"path\":\"\",\"label\":\"Custom.ResourceRecordSets\",\"context\":{\"outputPath\":\"addOns.ResourceRecordSets.data\"}},\"conditionalSettings\":{\"conditions\":[],\"expression\":\"\"},\"advanceOptions\":{}},{\"id\":\"node-cfba3819-data-formatter\",\"type\":\"data-formatter\",\"next\":\"node-c8099523-data-joiner\",\"previous\":\"node-69d49ad-filter\",\"inputs\":{\"customKeys\":[{\"key\":\"ExpectedBucketName\",\"value\":\"obj.ExpectedBucketName\",\"type\":\"any\"}],\"selectKeys\":{\"AliasTarget\":\"AliasTarget\",\"AliasTarget.DNSName\":\"AliasTarget.DNSName\",\"AliasTarget.EvaluateTargetHealth\":\"AliasTarget.EvaluateTargetHealth\",\"AliasTarget.HostedZoneId\":\"AliasTarget.HostedZoneId\",\"Failover\":\"Failover\",\"GeoLocation\":\"GeoLocation\",\"GeoLocation.ContinentCode\":\"GeoLocation.ContinentCode\",\"GeoLocation.CountryCode\":\"GeoLocation.CountryCode\",\"GeoLocation.SubdivisionCode\":\"GeoLocation.SubdivisionCode\",\"HealthCheckId\":\"HealthCheckId\",\"MultiValueAnswer\":\"MultiValueAnswer\",\"Name\":\"Name\",\"Region\":\"Region\",\"ResourceRecords\":\"ResourceRecords\",\"ResourceRecords.Value\":\"ResourceRecords.Value\",\"SetIdentifier\":\"SetIdentifier\",\"TTL\":\"TTL\",\"TrafficPolicyInstanceId\":\"TrafficPolicyInstanceId\",\"Type\":\"Type\",\"Weight\":\"Weight\"},\"type\":\"obj\"},\"target\":{\"script\":\"data-formatter\"},\"selectedResource\":{\"selectedResourceId\":\"node-69d49ad-filter\",\"path\":\"\",\"label\":\"Filter (2).ResourceRecordSets\",\"context\":{\"outputPath\":\"addOns.ResourceRecordSets.data\"}},\"conditionalSettings\":{\"conditions\":[],\"expression\":\"\"},\"advanceOptions\":{}},{\"id\":\"node-c8099523-data-joiner\",\"type\":\"data-joiner\",\"next\":\"node-1365da7e-filter\",\"previous\":\"node-cfba3819-data-formatter\",\"inputs\":{\"leftData\":\"$wf.node-cfba3819-data-formatter\",\"rightData\":\"$wf.node-248b884b-resource\",\"joinType\":\"inner\",\"matchKeys\":[{\"key1\":\"ExpectedBucketName\",\"key2\":\"Name\"}]},\"target\":{\"script\":\"data-joiner\"},\"selectedResource\":null,\"conditionalSettings\":{\"conditions\":[],\"expression\":\"\"},\"advanceOptions\":{}},{\"id\":\"node-1365da7e-filter\",\"type\":\"filter\",\"next\":\"node-a2868916-data-formatter\",\"previous\":\"node-c8099523-data-joiner\",\"inputs\":{\"conditions\":[{\"id\":\"c1\",\"type\":\"param\",\"key\":\"$.ExpectedBucketName\",\"value\":\"\",\"operator\":\"exists\"}],\"expression\":\"( (c1) )\"},\"target\":{\"script\":\"customFilter\"},\"selectedResource\":{\"selectedResourceId\":\"node-c8099523-data-joiner\",\"label\":\"Data Joiner.Data\",\"path\":\"\",\"context\":{\"outputPath\":\"\"}},\"conditionalSettings\":{\"conditions\":[],\"expression\":\"\"},\"advanceOptions\":{}},{\"id\":\"node-a2868916-data-formatter\",\"type\":\"data-formatter\",\"next\":\"node-784b932b-cloudview-control\",\"previous\":\"node-1365da7e-filter\",\"inputs\":{\"customKeys\":[],\"selectKeys\":{\"AliasTarget\":\"AliasTarget\",\"AliasTarget.DNSName\":\"AliasTarget.DNSName\",\"AliasTarget.EvaluateTargetHealth\":\"AliasTarget.EvaluateTargetHealth\",\"AliasTarget.HostedZoneId\":\"AliasTarget.HostedZoneId\",\"CreationDate\":\"CreationDate\",\"ExpectedBucketName\":\"ExpectedBucketName\",\"Failover\":\"Failover\",\"GeoLocation\":\"GeoLocation\",\"GeoLocation.ContinentCode\":\"GeoLocation.ContinentCode\",\"GeoLocation.CountryCode\":\"GeoLocation.CountryCode\",\"GeoLocation.SubdivisionCode\":\"GeoLocation.SubdivisionCode\",\"HealthCheckId\":\"HealthCheckId\",\"MultiValueAnswer\":\"MultiValueAnswer\",\"Name\":\"Name\",\"Region\":\"Region\",\"ResourceRecords\":\"ResourceRecords\",\"ResourceRecords.Value\":\"ResourceRecords.Value\",\"SetIdentifier\":\"SetIdentifier\",\"TTL\":\"TTL\",\"TrafficPolicyInstanceId\":\"TrafficPolicyInstanceId\",\"Type\":\"Type\",\"Weight\":\"Weight\"},\"type\":\"obj\"},\"target\":{\"script\":\"data-formatter\"},\"selectedResource\":{\"selectedResourceId\":\"node-1365da7e-filter\",\"path\":\"\",\"label\":\"Filter (3).Data\",\"context\":{\"outputPath\":\"\"}},\"conditionalSettings\":{\"conditions\":[],\"expression\":\"\"},\"advanceOptions\":{}},{\"id\":\"node-784b932b-cloudview-control\",\"type\":\"cloudview-control\",\"next\":null,\"previous\":\"node-a2868916-data-formatter\",\"inputs\":{\"selectKeys\":{\"Name\":\"Name\",\"ResourceRecords.Value\":\"ResourceRecords.Value\",\"Type\":\"Type\"},\"displayName\":\"Name\",\"resourceId\":\"Name\",\"cloudviewTriggerData\":\"$wf.trigger.data.0\",\"conditions\":[{\"id\":\"c1\",\"type\":\"param\",\"key\":\"$.ResourceRecords.Value\",\"value\":\"$wf.node-a2868916-data-formatter.Data.ResourceRecords.Value\",\"operator\":\"!=\"}],\"expression\":\"( (c1) )\"},\"target\":{\"script\":\"cloudview-control\"},\"selectedResource\":{\"selectedResourceId\":\"node-69d49ad-filter\",\"path\":\"\",\"label\":\"Filter (2).ResourceRecordSets\",\"context\":{\"outputPath\":\"addOns.ResourceRecordSets.data\"}},\"conditionalSettings\":{\"conditions\":[],\"expression\":\"\"},\"advanceOptions\":{}}]}",
    "deletedAt": null,
    "customerId": "",
    "name": "Subdomain Takeover Risk : S3 bucket not exists for S3 static website",
    "description": "This control identifies a potential subdomain takeover risk associated with an S3 static website URL for which a CNAME record has been created in Amazon Route 53",
    "state": "locked",
    "active": true,
    "properties": {
      "priority": 1,
      "severity": 1,
      "categories": {
        "services": [],
        "accounts": [
          ""
        ],
        "regions": [
          "us-east-1"
        ],
        "resource_groups": [],
        "projects": [],
        "solutions": [
          "AWS Best Practices"
        ],
        "apps": [
          "CV"
        ],
        "cloud_providers": [
          "AWS"
        ]
      },
      "hidden": false
    },
    "last_execution_details": {
      "executionEndDate": 1704765588442
    },
    "last_execution_status": "Success",
    "type": "normal",
    "user": "support@qualys.com"
  }
]