{"version":3,"file":"local-time-with-moment.js","names":["moment","fn","document","readyState","addEventListener","elements","querySelectorAll","index","length","element","datetime","getAttribute","format","locale","navigator","languages","m","innerText","lang","substr","setAttribute"],"sources":["../../../site/pages/asset/script/local-time-with-moment.js"],"sourcesContent":["/* global moment */\n\n/*\n * change all time tags (with datetime attributes) to the visitors local time\n */\n(function (moment) {\n\n\t\"use strict\";\n\n\t// helper function\n\tfunction ready(fn) {\n\t\tif (document.readyState !== \"loading\"){\n\t\t\tfn();\n\t\t} else {\n\t\t\tdocument.addEventListener(\"DOMContentLoaded\", fn);\n\t\t}\n\t}\n\n\t// wait for the document to be ready\n\tready(function () {\n\n\t\tif (!moment) {\n\n\t\t\t// if moment is not loaded, then don't bother\n\t\t\treturn;\n\n\t\t}\n\n\t\t// find all time tags with datetime attributes\n\t\t// and data-format attributes\n\t\tconst elements = document.querySelectorAll(\"time[datetime][data-format]\");\n\n\t\tif (elements) {\n\n\t\t\tfor (let index = 0, length = elements.length; index < length; index += 1) {\n\n\t\t\t\t// process each element found\n\t\t\t\tconst element = elements[index];\n\t\t\t\tconst datetime = element.getAttribute(\"datetime\");\n\t\t\t\tconst format = element.getAttribute(\"data-format\");\n\t\t\t\tlet locale = element.getAttribute(\"locale\");\n\n\t\t\t\tif (!locale) {\n\n\t\t\t\t\t// TODO ask browser for visitors preferred locale\n\t\t\t\t\tif (navigator.languages && navigator.languages.length > 0) {\n\t\t\t\t\t\tlocale = navigator.languages[0];\n\t\t\t\t\t} else {\n\t\t\t\t\t\tlocale = \"en\";\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\tif (datetime && format) {\n\n\t\t\t\t\t// replace contents with local time formatted by moment.js\n\t\t\t\t\tconst m = moment(datetime);\n\t\t\t\t\tm.locale(locale);\n\t\t\t\t\telement.innerText = m.format(format);\n\n\t\t\t\t\t// add lang attribute\n\t\t\t\t\t// since moment will use the language matching the locale\n\t\t\t\t\tconst lang = locale.substr(0, 2);\n\t\t\t\t\telement.setAttribute(\"lang\", lang);\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t});\n\n}(moment));\n"],"mappings":"aAAA,oBAEA;AACA;AACA,GACC,UAAUA,CAAM,CAAE,CAElB,YAAY,CAEZ;AASA;AACA,CATA,SAAeC,CAAE,CAAE,CACU,SAAS,GAAjCC,QAAQ,CAACC,UAAwB,CAGpCD,QAAQ,CAACE,gBAAgB,CAAC,kBAAkB,CAAEH,CAAE,CAAC,CAFjDA,CAAE,CAAC,CAIL,CAAC,EAGK,UAAY,CAEjB,GAAKD,CAAM,CAEV;AAAA,CAKD;AACA;AACA,KAAM,CAAAK,CAAQ,CAAGH,QAAQ,CAACI,gBAAgB,CAAC,6BAA6B,CAAC,CAEzE,GAAID,CAAQ,CAEX,IAAK,GAAI,CAAAE,CAAK,CAAG,CAAC,CAAEC,CAAM,CAAGH,CAAQ,CAACG,MAAM,CAAED,CAAK,CAAGC,CAAM,CAAED,CAAK,EAAI,CAAC,CAAE,CAEzE;AAAA,KACM,CAAAE,CAAO,CAAGJ,CAAQ,CAACE,CAAK,CAAC,CACzBG,CAAQ,CAAGD,CAAO,CAACE,YAAY,CAAC,UAAU,CAAC,CAC3CC,CAAM,CAAGH,CAAO,CAACE,YAAY,CAAC,aAAa,CAAC,CAClD,GAAI,CAAAE,CAAM,CAAGJ,CAAO,CAACE,YAAY,CAAC,QAAQ,CAAC,CAa3C,GAXKE,CAAM,GAGNC,SAAS,CAACC,SAAS,EAAiC,CAAC,CAA9BD,SAAS,CAACC,SAAS,CAACP,MAAU,CACxDK,CAAM,CAAGC,SAAS,CAACC,SAAS,CAAC,CAAC,CAAC,CAE/BF,CAAM,CAAG,IAAI,EAKXH,CAAQ,EAAIE,CAAM,CAAE,CAEvB;AACA,KAAM,CAAAI,CAAC,CAAGhB,CAAM,CAACU,CAAQ,CAAC,CAC1BM,CAAC,CAACH,MAAM,CAACA,CAAM,CAAC,CAChBJ,CAAO,CAACQ,SAAS,CAAGD,CAAC,CAACJ,MAAM,CAACA,CAAM,CAAC,CAEpC;AACA;AACA,KAAM,CAAAM,CAAI,CAAGL,CAAM,CAACM,MAAM,CAAC,CAAC,CAAE,CAAC,CAAC,CAChCV,CAAO,CAACW,YAAY,CAAC,MAAM,CAAEF,CAAI,CAElC,CAED,CAEA,CAEF,CAAC,CAEF,CAAC,EAAClB,MAAM,CAAC"}